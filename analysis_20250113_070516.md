好的，这是根据你提供的 markdown 文档创建的用户指南。

# Super Interview Repository Analysis 用户指南

这个工具旨在帮助你快速生成面试评估表格。它会读取 Google 文档中的面试问题，并生成相应的 Google 表单和电子表格，并自动生成预填链接，方便测试和发送。

## 1. 主要功能说明

这个工具的主要功能包括：

*   **读取面试问题：** 从指定的 Google 文档中读取面试问题。
*   **生成 Google 表单：** 根据读取的问题自动生成 Google 表单，并将表单链接到指定的 Google 表格。
*   **生成 Google 表格：** 生成一个用于收集面试回答的 Google 表格，其中包含问题和预期的答案。
*   **生成预填链接：**  为生成的 Google 表单创建预填链接，方便快速测试和填写。
*   **AI 自动生成答案：** 使用 Gemini API 为每个面试问题生成示例答案。
*   **根据评估维度生成评估表格**，为后续的面试评估提供基础
*   **生成评估报告:** 在表单提交后，使用AI对用户的答案进行分析，并生成评估报告。
*   **自动发送邮件:** 在表单提交后，自动将评估报告发送给指定的邮箱。
*   **文档管理：** 将生成的表单和表格保存到指定的 Google Drive 文件夹中。

## 2. 使用步骤

以下是使用这个工具的详细步骤：

1.  **准备工作**
    *   确保你已经设置好了所有必要的配置信息（见“3. 配置说明”）。
    *   准备一个包含面试问题的 Google 文档。每一行代表一个问题。
2.  **打开工具**
    *   打开你部署的 Google Apps Script 的 web app 链接。
3.  **选择问题文档**
    *   在页面上找到 “Step 1: Select Question Document and Enter Aspects” 部分， 从下拉菜单中选择包含面试问题的 Google 文档。
    *   在“Enter aspects” 输入框中填写评估维度， 例如：Technical, Communication, Leadership，使用英文逗号分隔。
4.  **生成表单**
    *   点击“Generate Form” 按钮。
    *   系统开始工作，页面上会显示“Generating...”的提示。
5.  **查看表单**
    *   **Step 2: Review and Confirm Form**
        *   点击 “Open Form” 按钮，查看生成的表单。
        *   如有需要，调整表单问题。
        *   确认后，点击“Confirm” 按钮。
    *   **Step 3: Response Sheet Setup**
        *  点击“Open Sheet” 按钮，打开数据表格。
        *  等待30秒，直到表格菜单栏出现 "Form Tools" 选项。
        *  点击 “Form Tools” > “Setup Form Trigger” 完成设置。
        *  点击“Confirm” 按钮。
    *   **Step 4: Test Submission**
        *   点击 “Open Form” 按钮打开预填表单。
        *   检查预填答案。
        *   滚动到表单底部，提交表单进行测试。
        *    点击“Confirm” 按钮。
    *   **Step 5: Send Interview Email**
         *   点击 “Open Gmail” 按钮，打开 Gmail。
         *    创建一个新邮件，将表单链接发送给候选人。
         *    点击“Confirm” 按钮。
6.  **获取表单链接**
    *   页面显示“Congratulations!” 的消息，代表流程完成。
    *   你可以在页面下方找到生成的表单链接。点击 “Copy URL” 按钮复制链接。

## 3. 配置说明

在使用此工具前，你需要配置以下信息。这些信息需要在 Google Apps Script 项目的“项目属性”中设置：

1.  **TEMPLATE\_SHEET\_ID：**
    *   这是你预先准备的 Google 表格模板的 ID。这个模板应该包含你希望在生成的表格中看到的格式和表头。
    *   你需要创建一个空白的 Google Sheet，作为模板。
    *   获取 Google Sheet 的 ID：打开 Google Sheet，查看浏览器地址栏，形如：`https://docs.google.com/spreadsheets/d/YOUR_SHEET_ID/edit`，`YOUR_SHEET_ID` 就是你需要的值。
2.  **QUESTIONS\_DOC\_ID：**
    *   这是包含面试问题的 Google 文档的 ID。
    *   获取 Google Doc 的 ID：打开 Google Doc，查看浏览器地址栏，形如：`https://docs.google.com/document/d/YOUR_DOC_ID/edit`，`YOUR_DOC_ID` 就是你需要的值。
3.  **TARGET\_FOLDER\_ID：**
    *   这是你希望将生成的表单和表格保存到的 Google Drive 文件夹的 ID。
    *   获取 Google Drive 文件夹 ID：打开 Google Drive，找到你的目标文件夹，查看浏览器地址栏，形如：`https://drive.google.com/drive/folders/YOUR_FOLDER_ID`，`YOUR_FOLDER_ID` 就是你需要的值。
4.  **QUESTIONS\_SHEET\_NAME：**
    *   这是在生成的 Google 表格中，用于存储面试问题的 Sheet 名称，默认值为“Form Questions”。
5.  **FORM\_TITLE：**
    *   这是生成的 Google 表单的默认标题，默认值为“Interview Questions Form”。
6.  **GEMINI\_API\_KEY：**
    *   这是访问 Gemini API 的 API 密钥。你需要从 Google Cloud Platform 获取该密钥。
    *    如何获取 API Key:
        1.  访问 Google Cloud Platform:  [https://console.cloud.google.com/](https://console.cloud.google.com/)
        2.  创建一个新的项目或选择一个已存在的项目。
        3.  搜索"API & Services" 并选择 "Credentials"。
        4.  选择 "Create Credentials" > "API key"。
        5.  复制生成的 API 密钥，并将其粘贴到配置中。
        6.  搜索 "Vertex AI API" 并 enable 该 API。
        7.  搜索 "Generative Language API" 并 enable 该 API.
        8.  访问 [https://makersuite.google.com/app/apikey](https://makersuite.google.com/app/apikey), 创建一个新的 API key。
7.  **PROJECT\_FOLDER\_ID：**
    * 这是包含你的 Google Docs 的 Google Drive 文件夹 ID。
    * 获取 Google Drive 文件夹 ID：打开 Google Drive，找到你的目标文件夹，查看浏览器地址栏，形如：`https://drive.google.com/drive/folders/YOUR_FOLDER_ID`，`YOUR_FOLDER_ID` 就是你需要的值。

## 4. 注意事项

*   请确保所有 Google Drive 的 ID 都正确无误。
*   请确保你已经设置了 Gemini API 密钥，并且密钥有效。
*   第一次使用时，需要在表格中配置 “Form Submit” 触发器，用于自动生成评估报告并发送邮件。
*   生成的表格，会包含一个名为 “Reports” 的Sheet，用于存储提交的报告。
*   请在 “Aspects” Sheet 中维护好你的评估维度，以便AI能够更好的进行评估。
*   此工具需要访问你的 Google Drive 和 Google Forms 的权限。
*   在进行批量生成表单前，建议先测试一个表单，确认所有流程正常。
*   请确保你的 Google Doc 的格式正确，每一行一个问题。
*   如果 Gemini API 调用失败，请检查 API 密钥和你的网络连接。
*   如果需要重置配置，请在 Google Apps Script 编辑器中运行 `resetConfig()` 函数。

希望这份指南能帮助你顺利使用这个工具！如有任何问题，请随时提出。

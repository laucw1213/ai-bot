Okay, here's a user guide for the "Super Interview Repository Analysis" tool, tailored for ordinary users, based on the provided markdown document:

# Super Interview Repository Analysis: User Guide

This guide will help you understand and use the Super Interview Repository Analysis tool to create interview forms and assessment reports.

## What it Does

This tool helps you:

1.  **Create Interview Forms:** Quickly generate Google Forms based on questions from a Google Doc.
2.  **Collect Responses:** Automatically create a Google Sheet to store responses from the form.
3.  **Prefill Answers:** Generate a pre-filled form with AI-suggested answers (powered by Gemini AI).
4.  **Assess Performance**: Automatically grade submitted responses and provide detailed analysis.
5.  **Email Reports**: Email the assessment report and detailed responses to designated email addresses.

## Key Features

*   **Easy Setup:** Quickly set up the system by selecting your source document and project folders.
*   **Automatic Generation:** Automatically generates the form, spreadsheet, prefilled links, and assessment report.
*   **AI-Powered:** Uses Gemini AI to suggest answers and create detailed assessments.
*   **Flexible Assessment:** Provides the capability to classify questions based on different aspects (e.g., technical, communication)
*   **Email Delivery**: Delivers generated reports and assessment results to designated recipients.

## Usage Steps

Here's how to use the tool:

### 1. Initial Setup (One-Time)

Before you start, ensure that all the following pre-requisites are in place:

1.  **Google Account:** You need a Google account.
2.  **Google Cloud Project Setup**: This script runs on Apps Script (Google Cloud), ensure you have a project setup.
3.  **Source Document**: Create a Google Doc with your interview questions (one question per line).
4.  **Template Sheet**: Create a Google Sheet that you will use as a template.
5.  **Target Folder**: Create a Google Drive folder where the new form and response sheet will be stored.
6.  **Project Folder**: Create a Google Drive folder where the tool will scan documents.
7.  **Gemini API Key**: Obtain an API key from Google Cloud's Gemini API.

### 2. Configure the Tool (One-Time)

1.  **Open Script**: Open the Apps Script editor associated with your project.
2.  **Set Configuration**: In `config.gs`, set the following Script Properties to the correct values:
    *   **`TEMPLATE_SHEET_ID`**: ID of your template Google Sheet.
    *   **`QUESTIONS_DOC_ID`**:  ID of the Google Doc containing the questions.
    *   **`TARGET_FOLDER_ID`**:  ID of the Google Drive folder where your form and sheet will be saved.
    *   **`GEMINI_API_KEY`**: Your Gemini API key.
    *   **`PROJECT_FOLDER_ID`**:  ID of the Google Drive folder containing the Google Docs.
3.  **Save Changes**: Save the changes to the script.

### 3. Using the Tool

1.  **Open Web App:** Deploy the Apps Script as a web application, and open it in your browser.
2.  **Select Document:** Choose your source document from the dropdown list of available documents.
3. **Enter Aspects**: Enter the aspects that you want to use for assessment, separated by commas.
    *   Example: `Technical, Communication, Leadership`
4.  **Generate Form:** Click the "Generate Form" button.
    *   The tool will now create a new Google Form, a Google Sheet for responses, and a prefilled form link. This may take some time.
5.  **Complete the Steps:** Follow the on-screen steps to review and complete the setup process.
    *   **Step 2**: Review the form in editor, and then click "Confirm".
    *   **Step 3**: Open response sheet. Wait 30 seconds, and Setup Form Trigger under "Form Tools". After completion, click "Confirm".
    *   **Step 4**: Open pre-filled form, and test the form by submitting. Then click "Confirm".
    *   **Step 5**: Open Gmail and send the link to an email address. Then click "Confirm".
6.  **Use the Form**: Once completed, you can then send the form to the interviewees.

### 4. View Responses and Assessment

1. **View Responses**: Open the Google Sheet created by the tool. This sheet will automatically collect responses from the Google Form.
2. **View Assessment**: A report on assessment will be automatically generated and sent to designated email recipients.

## Configuration Instructions

The tool requires a few configurations before it can work:

1.  **Template Sheet ID**:
    *   Create a blank Google Sheet.
    *   Copy the ID from the URL (e.g., in `https://docs.google.com/spreadsheets/d/YOUR_SHEET_ID/edit...`, the `YOUR_SHEET_ID` part).
2.  **Questions Document ID**:
    *   Create a Google Document with your questions, one question per line.
    *   Copy the ID from the URL (e.g., in `https://docs.google.com/document/d/YOUR_DOC_ID/edit...`, the `YOUR_DOC_ID` part).
3.  **Target Folder ID**:
    *   Create a Google Drive folder where the generated form and sheet will be stored.
    *   Copy the ID from the URL (e.g., in `https://drive.google.com/drive/folders/YOUR_FOLDER_ID`, the `YOUR_FOLDER_ID` part).
4.  **Gemini API Key**:
    *   Go to Google Cloud Console.
    *   Enable the Gemini API.
    *   Create an API key.
    *   Copy the key.
5.  **Project Folder ID**:
     *   Create a Google Drive folder where your Google Docs for generating forms are stored.
    *    Copy the ID from the URL (e.g., in `https://drive.google.com/drive/folders/YOUR_FOLDER_ID`, the `YOUR_FOLDER_ID` part).
6.  **Update `config.gs`**: Follow the guide above to update the script properties within the script.
7.  **Save Changes**: Save the changes you made to the script.

## Notes and Tips

*   **Gemini API Usage:**  The tool uses the Gemini API to generate suggested answers and validate questions. Ensure your API key is valid.
*   **Aspects**: Add as many categories as you need, but note that each question will be mapped to a category evenly.
*   **Question Validation:** The tool will validate that the questions are suitable for assessing the selected aspects.
*   **Email Settings**: Ensure that your email settings in Google Apps Script are set up to send emails. By default, emails are sent to the owner of the Google Sheet, as well as `alfred.lau@gemini.demo.hkmci.com`.
*   **Form Trigger**: After creation, you must set up the form trigger under "Form Tools" on the Google Sheet to enable automatic assessment reporting.
*   **User Interface**: The web interface provides clear steps and is designed for ease of use.
*   **Error Handling**: If you encounter any errors, check the logs in the Apps Script editor for details.

## Support
For questions or support, check the Apps Script logs or contact the administrator.

## Advanced Notes
*  **Aspects Sheet**: An "Aspects" sheet is automatically created on the response sheet for mapping questions to aspects.
*  **Reports Sheet**: A "Reports" sheet will be created for storing all generated reports.
*  **Custom Email**: You can customize the contents of the email, as well as the default email recipients in `test.gs`

This user guide should provide a good starting point for using the "Super Interview Repository Analysis" tool. If you have more specific questions, feel free to ask!
